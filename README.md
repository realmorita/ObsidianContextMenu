# ローカルコンテンツ埋め込み

このObsidianプラグインは、エディタのコンテキストメニュー（右クリックメニュー）に「ローカルからコンテンツを埋め込む」という項目を追加します。

## 主な機能

- コンテキストメニューからローカルのファイルを選択できます。
- 選択されたファイルの種類に応じて、適切なHTMLタグ形式でノートに埋め込みます。
    - **画像**: `<img src="file:///絶対パス" alt="ファイル名">`
    - **動画**: `<video controls src="file:///絶対パス"></video>`
    - **音声**: `<audio controls src="file:///絶対パス"></audio>`
    - **HTML/PDF**: `<iframe src="file:///絶対パス" width="100%" height="500px" frameborder="0"></iframe>`
- ファイルパスは、ローカルシステムの絶対パスを `file:///` プレフィックスを付けて使用します。
- ファイル選択ダイアログでは、画像、動画、音声、ドキュメント（HTML/PDF）、または「すべてのファイル」をフィルタとして選択できます。

## 注意事項

- **絶対パスと `file:///`**: このプラグインは、ローカルファイルの絶対パスに `file:///` プレフィックスを付けて埋め込みます。
    - **クロスプラットフォーム非互換**: 絶対パスで埋め込まれたコンテンツは、そのファイルが存在する特定のコンピュータでのみ正しく表示されます。他のデバイスやユーザーとノートを共有する場合、リンクは機能しません。
    - **セキュリティ**: ブラウザやOSのセキュリティ設定により、ローカルファイルへのアクセスが制限される場合があります。特に `file:///` リンクの動作は環境に依存することがあります。
    - **Vaultへのコピー推奨**: より堅牢でポータブルな方法として、ファイルをObsidianのVault内にコピーし、Vault内の相対パスを使用して埋め込むことを強く推奨します。
- **`<iframe>` のセキュリティ**: `<iframe>` を使用してHTMLコンテンツを埋め込む場合、潜在的なセキュリティリスクが伴います。信頼できるソースのファイルのみを埋込むようにしてください。
- **対応ファイル形式**: ファイルの拡張子に基づいてコンテンツの種類を判断し、以下の形式に対応しています。
    - 画像: `jpg`, `jpeg`, `png`, `gif`, `svg`, `webp`
    - 動画: `mp4`, `webm`, `ogg`, `mov`
    - 音声: `mp3`, `wav`, `ogg`, `aac`
    - ドキュメント (iframe): `html`, `pdf`
    - 上記以外の場合は、サポートされていない旨の通知が表示されます。
- **Electronダイアログの挙動**: ファイル選択ダイアログのデフォルトのファイルフィルタは、OSやElectronのバージョンによって挙動が異なる場合があります。

## 今後の改善点 (任意)

- Vaultへのファイル自動コピー機能（およびそのオン/オフ設定）。
- 相対パスでの埋め込みオプション。
- `<iframe>` のサンドボックス属性設定オプション。
- より詳細なエラーハンドリングとユーザーへのフィードバック。
